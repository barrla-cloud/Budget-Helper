{% extends 'base.html' %}
{% load custom_tags %}


{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
</script>
<canvas id="myChart"
    style="width:100%;max-width:700px;background-color: rgb(162, 231, 252); border-radius: 20px;margin: 30px;"></canvas>

<script>
    var xValues = []
    var yValues = []
    var color = "black"
    // {% for obj in category.category_info_set.all %}
    xValues.push("{{ obj.date|date:'d M' }}")
    yValues.push({{ obj.spend }})
    // {% endfor %}


    console.log(xValues)
    console.log(yValues)

    new Chart("myChart", {
        type: "line",
        data: {
            labels: xValues,
            datasets: [{
                label: "Spend per day",
                lineTension: 0,
                display: true,
                fill: false,
                backgroundColor: color,
                borderColor: "rgba(254,254,254,0.7)",
                data: yValues
            }]
        },
        options: {
            legend: {
                labels: {
                    fontColor: color,
                    fontSize: 14,
                }
            },
            scales: {
                yAxes: [{
                    gridLines: {
                        color: color
                    },
                    ticks: {
                        fontColor: color,
                        fontSize: 14,
                        beginAtZero: true
                    },
                    scaleLabel: {
                        display: true,
                        fontColor: color,
                        fontSize: 14,
                        labelString: 'Amount Spend (Rs)'
                    }
                }],
                xAxes: [{
                    gridLines: {
                        color: color
                    },
                    ticks: {
                        fontColor: color,
                        fontSize: 14,
                        beginAtZero: true
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Day',
                        fontColor: color,
                        fontSize: 14,
                    }
                }],
            },
        }
    });
</script>

<div class="container mt-5 mr-auto ml-0  text-left">
    {% for i in category.category_info_set.all %}
    <div class="cat-list justify-content-between d-flex " onclick="change({{i.pk}})">
        <span class="ml-0 ml-sm-5" style="font-weight: bold;">{{i.item}}</span>
        <span style="font-weight: bold;">{{i.spend}}</span>
        <span style="font-weight: bold;">{{i.date|date:"d D M"}}</span>
        <a href="{% url 'cat_delete' i.pk%}" class="btn btn-danger mr-sm-5 mr-0">Delete</a>
    </div>
    {% endfor %}
</div>
{% endblock content %}